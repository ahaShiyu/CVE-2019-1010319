diff --git a/test.c b/test.c
index 7beffe6..c1364a9 100644
--- a/test.c
+++ b/test.c
@@ -56,6 +56,7 @@ int ParseWave64HeaderConfig (FILE *infile, char *infilename, char *fourcc, Wavpa
     int format_chunk = 0;
     uint32_t bcount;
 
+    CLEAR (WaveHeader);
     infilesize = DoGetFileSize (infile);
     memcpy (&filehdr, fourcc, 4);
 
@@ -216,8 +217,13 @@ int ParseWave64HeaderConfig (FILE *infile, char *infilename, char *fourcc, Wavpa
             if ((config->qmode & QMODE_IGNORE_LENGTH) || chunk_header.ckSize <= 0) {
                 config->qmode |= QMODE_IGNORE_LENGTH;
 
-                if (infilesize && DoGetFilePosition (infile) != -1)
+                if (infilesize && DoGetFilePosition (infile) != -1) {
                     total_samples = (infilesize - DoGetFilePosition (infile)) / WaveHeader.BlockAlign;
+
+                    if ((infilesize - DoGetFilePosition (infile)) % WaveHeader.BlockAlign)
+                        error_line ("warning: audio length does not divide evenly, %d bytes will be discarded!",
+                            (int)((infilesize - DoGetFilePosition (infile)) % WaveHeader.BlockAlign));
+                }
                 else
                     total_samples = -1;
             }
@@ -361,4 +367,3 @@ int WriteWave64Header (FILE *outfile, WavpackContext *wpc, int64_t total_samples
 
     return TRUE;
 }
-
